#!/usr/bin/python3
import subprocess
import sys
from collections import defaultdict

RF_ON = "156 488 167 469 498 142 170 470 480 167 488 152 488 152 169 472 161 481 156 483 169 471 169 472 165 477 476 168 482 156 167 4962 152 482 490 150 170 471 481 168 149 489 165 475 166 470 487 155 161 483 154 491 159 476 484 161 155 483 484 156 488 151 490 154 161 488 146 489 163 477 163 479 158 481 151 491 482 157 487 155 165 4960 153 491 481 152 168 472 486 157 158 488 154 481 167 475 484 159 158 486 151 485 166 473 485 157 158 485 480 159 488 153 482 162 154 488 159 479 166 476 163 476 161 483 152 489 479 158 487 155 170 4960 154 481 485 154 168 475 476 168 150 493 156 480 165 471 523 129 148 487 164 473 165 478 477 169 151 486 485 155 480 165 470 171 157 485 160 476 165 478 157 484 152 491 160 475 486 160 483 159 151 4969 165 472 485 162 154 491 474 164 161 478 162 479 153 497 472 158 165 478 159 483 150 489 485 156 164 476 482 158 479 169 470 167 161 480 163 476 164 478 157 488 150 486 176 464 490 153 473 173 151 4971 159 478 490 150 156 488 479 160 164 476 157 490 155 480 486 154 166 475 162 482 150 490 484 155 164 477 483 161 474 172 474 163 160 479 163 479 155 489 150 487 163 476 164 486 470 166 471 170 157 4970 148 490 484 155 163 476 482 160 157 488 151 509 133 494 462 168 159 480 164 477 162 477 477 168 150 491 480 160 483 157 479 164 153 493 151 486 160 478 162 480 157 526 110 491 482 161 481 160 158 5383"

RF_OFF = "119 504 156 495 137 491 489 170 122 504 491 161 473 166 495 140 147 501 123 509 154 484 143 502 491 166 453 177 120 509 149 508 108 4998 40 622 59 197 60 363 49 551 42 177 63 385 56 553 45 612 79 545 60 103 41 111 29 309 78 540 55 581 36 608 76 90 45 102 41 303 93 530 75 78 48 96 41 321 442 177 64 78 53 86 51 315 106 518 59 601 106 516 146 497 468 178 490 149 136 507 119 508 162 4966 117 515 474 174 132 492 494 165 132 491 176 480 132 498 501 165 116 500 173 458 178 467 518 132 163 462 490 164 517 121 489 159 138 488 178 464 158 484 175 462 480 169 518 121 170 465 155 485 185 4940 147 481 496 162 141 484 501 154 140 489 187 443 179 476 517 119 178 459 162 479 190 443 489 162 173 455 494 166 151 474 502 147 151 482 193 445 172 475 173 460 182 462 160 480 194 441 172 477 177 103418"

def on():
    subprocess.check_output('pilight-send -p raw -c "{}"'.format(RF_ON), shell=True)

def off():
    subprocess.check_output('pilight-send -p raw -c "{}"'.format(RF_OFF), shell=True)

# codes = defaultdict(int)
# with open('tmp.txt', 'r') as f:
#     lines = f.readlines()
#     for i, line in enumerate(lines):
#         if line.startswith('Raw code:') and i < len(lines) - 1:
#             codes[lines[i+1].strip()] += 1
# print('n codes: {}'.format(len(codes.keys())))
#
# for code in codes.keys():
#     if code == RF_ON:
#         print('check0')
#     elif code == RF_OFF:
#         print('check1')

# good_codes = []
# for code in sorted(codes.keys(), key=lambda x: len(x)):
#     print(code)
#     print('n hits: {}'.format(codes[code]))
#     subprocess.check_output('pilight-send -p raw -c "{}"'.format(code), shell=True)
#     good = input('> ')
#     if good:
#         print('yay')
#         good_codes.append(good)
# print(good_codes)

# receive codes: service pilight stop && pilight-debug


if __name__ == '__main__':
    if len(sys.argv) > 1 and sys.argv[1] == 'on':
        on()
    elif len(sys.argv) > 1 and sys.argv[1] == 'off':
        off()
    else:
        print('usage: python3 light.py on/off')
